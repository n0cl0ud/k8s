<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Composants Kubernetes D√©taill√©s</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        
        .subtitle {
            text-align: center;
            opacity: 0.9;
            margin-bottom: 40px;
            font-size: 1.2em;
        }
        
        .components-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .component-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }
        
        .component-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
            border-color: #4CAF50;
        }
        
        .component-card.active {
            border-color: #4CAF50;
            box-shadow: 0 0 30px rgba(76, 175, 80, 0.4);
        }
        
        .component-icon {
            font-size: 3em;
            text-align: center;
            margin-bottom: 15px;
        }
        
        .component-title {
            font-size: 1.5em;
            font-weight: bold;
            text-align: center;
            margin-bottom: 10px;
        }
        
        .component-role {
            text-align: center;
            opacity: 0.8;
            margin-bottom: 15px;
            font-style: italic;
        }
        
        .detail-panel {
            display: none;
            background: rgba(0, 0, 0, 0.9);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 1000;
            padding: 40px;
            overflow-y: auto;
        }
        
        .detail-content {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 40px;
            position: relative;
        }
        
        .close-btn {
            position: absolute;
            top: 20px;
            right: 30px;
            background: none;
            border: none;
            color: white;
            font-size: 2em;
            cursor: pointer;
            padding: 10px;
            border-radius: 50%;
            transition: all 0.3s ease;
        }
        
        .close-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: rotate(90deg);
        }
        
        .detail-sections {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 30px;
        }
        
        .detail-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
        }
        
        .detail-section h3 {
            color: #4CAF50;
            margin-bottom: 15px;
            font-size: 1.3em;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 5px;
        }
        
        .api-endpoint {
            background: #1a1a1a;
            color: #00ff00;
            font-family: 'Courier New', monospace;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 4px solid #4CAF50;
        }
        
        .process-flow {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }
        
        .metric {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .metric:last-child {
            border-bottom: none;
        }
        
        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            gap: 10px;
        }
        
        .tab {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .tab.active {
            background: #4CAF50;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
        }
        
        .architecture-diagram {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
            text-align: center;
        }
        
        .node-diagram {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 20px 0;
        }
        
        .node {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 20px;
            min-width: 150px;
            border: 2px solid #4CAF50;
        }
        
        .arrow-between {
            color: #4CAF50;
            font-size: 2em;
            margin: 0 20px;
        }
        
        .code-block {
            background: #1a1a1a;
            color: #f8f8f2;
            font-family: 'Courier New', monospace;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            overflow-x: auto;
            border-left: 5px solid #4CAF50;
        }
        
        .highlight {
            background: rgba(76, 175, 80, 0.2);
            padding: 2px 6px;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üèóÔ∏è Kubernetes Components</h1>
        <p class="subtitle">Exploration interactive des composants du cluster</p>
        
        <div class="tabs">
            <button class="tab active" onclick="showTab('control-plane')">üéØ Control Plane</button>
            <button class="tab" onclick="showTab('worker-nodes')">üë∑ Worker Nodes</button>
            <button class="tab" onclick="showTab('add-ons')">üîå Add-ons</button>
        </div>
        
        <div id="control-plane" class="tab-content">
            <div class="components-grid">
                <div class="component-card" onclick="showDetail('api-server')">
                    <div class="component-icon">üåê</div>
                    <div class="component-title">API Server</div>
                    <div class="component-role">Porte d'entr√©e du cluster</div>
                    <p>Point central de toutes les communications. Expose l'API REST Kubernetes et valide/persiste les objets.</p>
                </div>
                
                <div class="component-card" onclick="showDetail('etcd')">
                    <div class="component-icon">üóÑÔ∏è</div>
                    <div class="component-title">etcd</div>
                    <div class="component-role">Base de donn√©es du cluster</div>
                    <p>Stockage cl√©-valeur distribu√© et coh√©rent. Contient tout l'√©tat du cluster Kubernetes.</p>
                </div>
                
                <div class="component-card" onclick="showDetail('scheduler')">
                    <div class="component-icon">üìã</div>
                    <div class="component-title">Scheduler</div>
                    <div class="component-role">Organisateur de workloads</div>
                    <p>D√©cide sur quel n≈ìud placer chaque pod selon les ressources et contraintes.</p>
                </div>
                
                <div class="component-card" onclick="showDetail('controller-manager')">
                    <div class="component-icon">üéÆ</div>
                    <div class="component-title">Controller Manager</div>
                    <div class="component-role">Boucles de contr√¥le</div>
                    <p>Ex√©cute les contr√¥leurs qui r√©gulent l'√©tat du cluster (Deployments, Services, etc.).</p>
                </div>
            </div>
        </div>
        
        <div id="worker-nodes" class="tab-content" style="display: none;">
            <div class="components-grid">
                <div class="component-card" onclick="showDetail('kubelet')">
                    <div class="component-icon">ü§ñ</div>
                    <div class="component-title">Kubelet</div>
                    <div class="component-role">Agent du n≈ìud</div>
                    <p>Assure que les containers tournent dans les pods assign√©s √† son n≈ìud.</p>
                </div>
                
                <div class="component-card" onclick="showDetail('kube-proxy')">
                    <div class="component-icon">üîÄ</div>
                    <div class="component-title">kube-proxy</div>
                    <div class="component-role">Proxy r√©seau</div>
                    <p>Maintient les r√®gles r√©seau et permet la communication avec les pods.</p>
                </div>
                
                <div class="component-card" onclick="showDetail('container-runtime')">
                    <div class="component-icon">üì¶</div>
                    <div class="component-title">Container Runtime</div>
                    <div class="component-role">Moteur de containers</div>
                    <p>Docker, containerd, CRI-O - ex√©cute et g√®re les containers.</p>
                </div>
            </div>
        </div>
        
        <div id="add-ons" class="tab-content" style="display: none;">
            <div class="components-grid">
                <div class="component-card" onclick="showDetail('dns')">
                    <div class="component-icon">üîç</div>
                    <div class="component-title">CoreDNS</div>
                    <div class="component-role">Service de noms</div>
                    <p>R√©solution DNS pour les services et pods dans le cluster.</p>
                </div>
                
                <div class="component-card" onclick="showDetail('dashboard')">
                    <div class="component-icon">üìä</div>
                    <div class="component-title">Dashboard</div>
                    <div class="component-role">Interface web</div>
                    <p>Interface utilisateur web pour g√©rer et surveiller le cluster.</p>
                </div>
                
                <div class="component-card" onclick="showDetail('ingress')">
                    <div class="component-icon">üö™</div>
                    <div class="component-title">Ingress Controller</div>
                    <div class="component-role">Routeur HTTP</div>
                    <p>G√®re l'acc√®s externe aux services via HTTP/HTTPS.</p>
                </div>
            </div>
        </div>
        
        <div class="architecture-diagram">
            <h2>üèóÔ∏è Architecture Globale</h2>
            <div class="node-diagram">
                <div class="node">
                    <strong>Master Node</strong><br>
                    API Server<br>
                    etcd<br>
                    Scheduler<br>
                    Controller Manager
                </div>
                <div class="arrow-between">‚Üí</div>
                <div class="node">
                    <strong>Worker Node 1</strong><br>
                    Kubelet<br>
                    kube-proxy<br>
                    Container Runtime<br>
                    Pods
                </div>
                <div class="arrow-between">‚Üí</div>
                <div class="node">
                    <strong>Worker Node 2</strong><br>
                    Kubelet<br>
                    kube-proxy<br>
                    Container Runtime<br>
                    Pods
                </div>
            </div>
        </div>
    </div>

    <!-- Detail Panels pour chaque composant -->
    <div id="detail-api-server" class="detail-panel">
        <div class="detail-content">
            <button class="close-btn" onclick="closeDetail()">√ó</button>
            <h2>üåê API Server - Le Cerveau Central</h2>
            
            <div class="detail-sections">
                <div class="detail-section">
                    <h3>üîß Responsabilit√©s</h3>
                    <ul>
                        <li><strong>Validation</strong> des requ√™tes API</li>
                        <li><strong>Authentification</strong> et autorisation</li>
                        <li><strong>Mutation</strong> des objets (webhooks)</li>
                        <li><strong>S√©rialisation</strong> vers etcd</li>
                        <li><strong>Watching</strong> des changements</li>
                    </ul>
                    
                    <h3>üîå API Endpoints</h3>
                    <div class="api-endpoint">GET /api/v1/pods</div>
                    <div class="api-endpoint">POST /api/v1/namespaces/default/pods</div>
                    <div class="api-endpoint">GET /apis/apps/v1/deployments</div>
                </div>
                
                <div class="detail-section">
                    <h3>‚ö° Processus Interne</h3>
                    <div class="process-flow">
                        <strong>1. Requ√™te HTTP</strong> ‚Üí Parsing JSON/YAML<br>
                        <strong>2. Authentification</strong> ‚Üí Tokens, Certificats<br>
                        <strong>3. Autorisation</strong> ‚Üí RBAC, ABAC<br>
                        <strong>4. Admission Control</strong> ‚Üí Webhooks<br>
                        <strong>5. Validation</strong> ‚Üí Schema OpenAPI<br>
                        <strong>6. Stockage etcd</strong> ‚Üí Persistence<br>
                        <strong>7. R√©ponse</strong> ‚Üí JSON vers client
                    </div>
                    
                    <h3>üìä M√©triques Typiques</h3>
                    <div class="metric">
                        <span>Requ√™tes/sec</span>
                        <span class="highlight">~1000-5000</span>
                    </div>
                    <div class="metric">
                        <span>Latence p99</span>
                        <span class="highlight">&lt; 100ms</span>
                    </div>
                    <div class="metric">
                        <span>Port</span>
                        <span class="highlight">6443 (HTTPS)</span>
                    </div>
                </div>
            </div>
            
            <div class="code-block">
# Configuration typique API Server
kube-apiserver \
  --advertise-address=10.0.0.1 \
  --etcd-servers=https://127.0.0.1:2379 \
  --service-cluster-ip-range=10.96.0.0/12 \
  --authorization-mode=RBAC \
  --enable-admission-plugins=NodeRestriction,MutatingAdmissionWebhook
            </div>
        </div>
    </div>

    <!-- Continuer avec les autres composants... -->
    <div id="detail-etcd" class="detail-panel">
        <div class="detail-content">
            <button class="close-btn" onclick="closeDetail()">√ó</button>
            <h2>üóÑÔ∏è etcd - La M√©moire du Cluster</h2>
            
            <div class="detail-sections">
                <div class="detail-section">
                    <h3>üíæ Structure des Donn√©es</h3>
                    <div class="process-flow">
                        <strong>/registry/pods/default/my-pod</strong><br>
                        <strong>/registry/services/kube-system/kube-dns</strong><br>
                        <strong>/registry/deployments/default/nginx</strong><br>
                        <strong>/registry/secrets/default/db-password</strong>
                    </div>
                    
                    <h3>üîÑ Fonctionnalit√©s</h3>
                    <ul>
                        <li><strong>MVCC</strong> - Multi-Version Concurrency Control</li>
                        <li><strong>Watch</strong> - Notifications de changements</li>
                        <li><strong>Transactions</strong> - Op√©rations atomiques</li>
                        <li><strong>Lease</strong> - TTL pour les objets</li>
                        <li><strong>Compaction</strong> - Nettoyage historique</li>
                    </ul>
                </div>
                
                <div class="detail-section">
                    <h3>üéØ Algorithme Raft</h3>
                    <div class="process-flow">
                        <strong>Leader Election</strong> ‚Üí Un seul leader actif<br>
                        <strong>Log Replication</strong> ‚Üí Copie sur tous les n≈ìuds<br>
                        <strong>Consensus</strong> ‚Üí Majorit√© doit accepter<br>
                        <strong>Fault Tolerance</strong> ‚Üí Survit √† N/2-1 pannes
                    </div>
                    
                    <h3>üìä Performance</h3>
                    <div class="metric">
                        <span>√âcritures/sec</span>
                        <span class="highlight">~10,000</span>
                    </div>
                    <div class="metric">
                        <span>Lectures/sec</span>
                        <span class="highlight">~100,000</span>
                    </div>
                    <div class="metric">
                        <span>Port</span>
                        <span class="highlight">2379 (client), 2380 (peer)</span>
                    </div>
                </div>
            </div>
            
            <div class="code-block">
# Commandes etcd utiles
export ETCDCTL_API=3

# Lister toutes les cl√©s
etcdctl get "" --prefix --keys-only

# Voir un pod sp√©cifique  
etcdctl get /registry/pods/default/my-pod

# Backup du cluster
etcdctl snapshot save backup.db

# Restaurer depuis backup
etcdctl snapshot restore backup.db
            </div>
        </div>
    </div>

    <div id="detail-scheduler" class="detail-panel">
        <div class="detail-content">
            <button class="close-btn" onclick="closeDetail()">√ó</button>
            <h2>üìã Scheduler - L'Intelligence de Placement</h2>
            
            <div class="detail-sections">
                <div class="detail-section">
                    <h3>üß† Algorithme de Scheduling</h3>
                    <div class="process-flow">
                        <strong>1. Filtering</strong> ‚Üí √âliminer n≈ìuds inad√©quats<br>
                        <strong>2. Scoring</strong> ‚Üí Noter chaque n≈ìud viable<br>
                        <strong>3. Selection</strong> ‚Üí Choisir le meilleur score<br>
                        <strong>4. Binding</strong> ‚Üí Assigner pod au n≈ìud
                    </div>
                    
                    <h3>üéØ Crit√®res de Filtrage</h3>
                    <ul>
                        <li><strong>NodeSelector</strong> - Labels obligatoires</li>
                        <li><strong>Taints/Tolerations</strong> - Restrictions</li>
                        <li><strong>Resource Requests</strong> - CPU/RAM suffisants</li>
                        <li><strong>Affinity Rules</strong> - Colocation pr√©f√©r√©e</li>
                        <li><strong>Volume Zones</strong> - Disponibilit√© stockage</li>
                    </ul>
                </div>
                
                <div class="detail-section">
                    <h3>üìä Scoring Functions</h3>
                    <div class="process-flow">
                        <strong>LeastRequestedPriority</strong> ‚Üí N≈ìuds moins charg√©s<br>
                        <strong>BalancedResourceAllocation</strong> ‚Üí √âquilibre CPU/RAM<br>
                        <strong>NodeAffinityPriority</strong> ‚Üí Pr√©f√©rences affinity<br>
                        <strong>InterPodAffinityPriority</strong> ‚Üí Colocation pods
                    </div>
                    
                    <h3>‚ö° Performance</h3>
                    <div class="metric">
                        <span>Pods/sec</span>
                        <span class="highlight">~100-500</span>
                    </div>
                    <div class="metric">
                        <span>Latence scheduling</span>
                        <span class="highlight">&lt; 100ms</span>
                    </div>
                    <div class="metric">
                        <span>Queue depth</span>
                        <span class="highlight">Variable</span>
                    </div>
                </div>
            </div>
            
            <div class="code-block">
# Configuration scheduler custom
apiVersion: kubescheduler.config.k8s.io/v1beta3
kind: KubeSchedulerConfiguration
profiles:
- schedulerName: my-scheduler
  plugins:
    score:
      enabled:
      - name: NodeResourcesFit
      - name: NodeAffinity
  pluginConfig:
  - name: NodeResourcesFit
    args:
      scoringStrategy:
        type: LeastAllocated
            </div>
        </div>
    </div>

    <!-- Controller Manager Details -->
    <div id="detail-controller-manager" class="detail-panel">
        <div class="detail-content">
            <button class="close-btn" onclick="closeDetail()">√ó</button>
            <h2>üéÆ Controller Manager - Les Boucles de Contr√¥le</h2>
            
            <div class="detail-sections">
                <div class="detail-section">
                    <h3>üîÑ Contr√¥leurs Principaux</h3>
                    <div class="process-flow">
                        <strong>Deployment Controller</strong> ‚Üí G√®re ReplicaSets<br>
                        <strong>ReplicaSet Controller</strong> ‚Üí Maintient nb pods<br>
                        <strong>Node Controller</strong> ‚Üí Surveille sant√© n≈ìuds<br>
                        <strong>Service Controller</strong> ‚Üí G√®re LoadBalancers<br>
                        <strong>Endpoint Controller</strong> ‚Üí Sync services/pods<br>
                        <strong>Namespace Controller</strong> ‚Üí Nettoyage NS<br>
                        <strong>PV Controller</strong> ‚Üí Binding volumes
                    </div>
                    
                    <h3>‚ö° Boucle de Contr√¥le</h3>
                    <div class="process-flow">
                        <strong>1. Watch API</strong> ‚Üí √âcoute changements etcd<br>
                        <strong>2. Compare State</strong> ‚Üí Actuel vs D√©sir√©<br>
                        <strong>3. Take Action</strong> ‚Üí Correction si diff√©rence<br>
                        <strong>4. Update Status</strong> ‚Üí Rapport √©tat<br>
                        <strong>5. Requeue</strong> ‚Üí R√©p√©ter dans X sec
                    </div>
                </div>
                
                <div class="detail-section">
                    <h3>üéØ D√©ploiement Pod - Actions</h3>
                    <div class="process-flow">
                        <strong>Deployment Created</strong> ‚Üí Controller d√©tecte<br>
                        <strong>Create ReplicaSet</strong> ‚Üí Avec template pod<br>
                        <strong>ReplicaSet Controller</strong> ‚Üí Cr√©e pods manquants<br>
                        <strong>Endpoint Controller</strong> ‚Üí Maj endpoints service<br>
                        <strong>Node Controller</strong> ‚Üí V√©rifie capacit√© n≈ìud
                    </div>
                    
                    <h3>üìä M√©triques</h3>
                    <div class="metric">
                        <span>Controllers actifs</span>
                        <span class="highlight">~20-30</span>
                    </div>
                    <div class="metric">
                        <span>Boucle fr√©quence</span>
                        <span class="highlight">30s par d√©faut</span>
                    </div>
                    <div class="metric">
                        <span>Worker threads</span>
                        <span class="highlight">5 par controller</span>
                    </div>
                </div>
            </div>
            
            <div class="code-block">
# Exemple: ReplicaSet Controller en action
kubectl create deployment nginx --image=nginx --replicas=3

# Controller observe:
# Desired: 3 pods nginx
# Actual: 0 pods nginx  
# Action: Cr√©er 3 pods

# Logs controller:
I0729 controller.go:156] "ReplicaSet nginx-xyz created 3 pods"
I0729 controller.go:189] "Deployment nginx rollout complete"
            </div>
        </div>
    </div>

    <!-- Kubelet Details -->
    <div id="detail-kubelet" class="detail-panel">
        <div class="detail-content">
            <button class="close-btn" onclick="closeDetail()">√ó</button>
            <h2>ü§ñ Kubelet - L'Agent du N≈ìud</h2>
            
            <div class="detail-sections">
                <div class="detail-section">
                    <h3>üîß Responsabilit√©s</h3>
                    <ul>
                        <li><strong>Pod Lifecycle</strong> - Cr√©ation/Suppression pods</li>
                        <li><strong>Container Management</strong> - Via CRI</li>
                        <li><strong>Volume Mounting</strong> - Stockage persistant</li>
                        <li><strong>Network Setup</strong> - Via CNI</li>
                        <li><strong>Health Checks</strong> - Liveness/Readiness</li>
                        <li><strong>Resource Monitoring</strong> - CPU/RAM usage</li>
                        <li><strong>Node Status</strong> - Heartbeat vers API</li>
                    </ul>
                    
                    <h3>‚ö° D√©ploiement Pod - √âtapes</h3>
                    <div class="process-flow">
                        <strong>1. Watch API</strong> ‚Üí Pod assign√© √† ce n≈ìud<br>
                        <strong>2. Create Sandbox</strong> ‚Üí Pod network namespace<br>
                        <strong>3. Pull Images</strong> ‚Üí T√©l√©chargement containers<br>
                        <strong>4. Mount Volumes</strong> ‚Üí Attachement stockage<br>
                        <strong>5. Start Containers</strong> ‚Üí Ordre init ‚Üí main<br>
                        <strong>6. Health Checks</strong> ‚Üí Probes d√©marrent<br>
                        <strong>7. Update Status</strong> ‚Üí Pod Running vers API
                    </div>
                </div>
                
                <div class="detail-section">
                    <h3>üîå Interfaces (CRI/CNI/CSI)</h3>
                    <div class="process-flow">
                        <strong>CRI (Container Runtime)</strong><br>
                        - RuntimeService: Manage pods/containers<br>
                        - ImageService: Pull/List images<br><br>
                        
                        <strong>CNI (Container Network)</strong><br>
                        - ADD: Setup pod network<br>
                        - DEL: Cleanup network<br><br>
                        
                        <strong>CSI (Container Storage)</strong><br>
                        - Mount/Unmount volumes<br>
                        - Expand volumes
                    </div>
                    
                    <h3>üìä Surveillance</h3>
                    <div class="metric">
                        <span>Heartbeat API</span>
                        <span class="highlight">10s interval</span>
                    </div>
                    <div class="metric">
                        <span>Pod sync</span>
                        <span class="highlight">1s interval</span>
                    </div>
                    <div class="metric">
                        <span>Port</span>
                        <span class="highlight">10250 (API), 10255 (readonly)</span>
                    </div>
                </div>
            </div>
            
            <div class="code-block">
# Configuration kubelet
kubelet \
  --config=/var/lib/kubelet/config.yaml \
  --container-runtime=remote \
  --container-runtime-endpoint=unix:///var/run/containerd/containerd.sock \
  --pod-cidr=10.244.1.0/24 \
  --cluster-dns=10.96.0.10

# Logs deployment pod
I0729 kubelet.go:1956] "SyncLoop received pod" pod="default/nginx-abc123"
I0729 kuberuntime_manager.go:744] "CreatePodSandbox for pod" pod="nginx-abc123"
I0729 kuberuntime_manager.go:872] "Pulling image" image="nginx:latest"
I0729 kuberuntime_manager.go:456] "StartContainer" container="nginx"
I0729 kubelet.go:2145] "Pod is running" pod="nginx-abc123"
            </div>
        </div>
    </div>

    <!-- kube-proxy Details -->
    <div id="detail-kube-proxy" class="detail-panel">
        <div class="detail-content">
            <button class="close-btn" onclick="closeDetail()">√ó</button>
            <h2>üîÄ kube-proxy - Le Routeur de Services</h2>
            
            <div class="detail-sections">
                <div class="detail-section">
                    <h3>üåê Modes de Proxy</h3>
                    <div class="process-flow">
                        <strong>iptables (default)</strong><br>
                        - R√®gles iptables pour NAT<br>
                        - Load balancing round-robin<br>
                        - Pas de userspace overhead<br><br>
                        
                        <strong>IPVS (performance)</strong><br>
                        - Kernel load balancer<br>
                        - Algorithms: rr, lc, dh, sh<br>
                        - Meilleure performance<br><br>
                        
                        <strong>userspace (legacy)</strong><br>
                        - Proxy dans l'espace utilisateur<br>
                        - Plus lent mais compatible
                    </div>
                    
                    <h3>‚ö° D√©ploiement Pod Impact</h3>
                    <div class="process-flow">
                        <strong>Service Created</strong> ‚Üí kube-proxy watch<br>
                        <strong>Endpoints Updated</strong> ‚Üí Nouveau pod IP<br>
                        <strong>iptables Rules</strong> ‚Üí NAT vers pod IP<br>
                        <strong>Load Balancing</strong> ‚Üí Distribution traffic
                    </div>
                </div>
                
                <div class="detail-section">
                    <h3>üîß R√®gles iptables Exemple</h3>
                    <div class="code-block" style="font-size: 0.8em;">
# Service nginx (ClusterIP: 10.96.123.45)
-A KUBE-SERVICES -d 10.96.123.45/32 -p tcp -m tcp --dport 80 -j KUBE-SVC-XYZ

# Load balancing vers 3 pods
-A KUBE-SVC-XYZ -m statistic --mode random --probability 0.33333 -j KUBE-SEP-ABC
-A KUBE-SVC-XYZ -m statistic --mode random --probability 0.50000 -j KUBE-SEP-DEF  
-A KUBE-SVC-XYZ -j KUBE-SEP-GHI

# Destination pods
-A KUBE-SEP-ABC -p tcp -m tcp -j DNAT --to-destination 10.244.1.5:80
-A KUBE-SEP-DEF -p tcp -m tcp -j DNAT --to-destination 10.244.2.8:80
-A KUBE-SEP-GHI -p tcp -m tcp -j DNAT --to-destination 10.244.3.2:80
                    </div>
                    
                    <h3>üìä Performance</h3>
                    <div class="metric">
                        <span>Sync frequency</span>
                        <span class="highlight">30s</span>
                    </div>
                    <div class="metric">
                        <span>iptables rules</span>
                        <span class="highlight">~1000-10000</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Container Runtime Details -->
    <div id="detail-container-runtime" class="detail-panel">
        <div class="detail-content">
            <button class="close-btn" onclick="closeDetail()">√ó</button>
            <h2>üì¶ Container Runtime - Le Moteur d'Ex√©cution</h2>
            
            <div class="detail-sections">
                <div class="detail-section">
                    <h3>üèÉ Runtimes Disponibles</h3>
                    <div class="process-flow">
                        <strong>containerd (recommand√©)</strong><br>
                        - CNCF graduated project<br>
                        - OCI compliant<br>
                        - L√©ger et performant<br><br>
                        
                        <strong>Docker Engine</strong><br>
                        - Interface dockershim (deprecated)<br>
                        - Via cri-dockerd<br><br>
                        
                        <strong>CRI-O</strong><br>
                        - Sp√©cialement pour Kubernetes<br>
                        - OCI runtime minimal
                    </div>
                    
                    <h3>‚ö° Container Lifecycle</h3>
                    <div class="process-flow">
                        <strong>1. Image Pull</strong> ‚Üí Registry download<br>
                        <strong>2. Create Container</strong> ‚Üí OCI spec<br>
                        <strong>3. Start Process</strong> ‚Üí Entrypoint exec<br>
                        <strong>4. Monitor Health</strong> ‚Üí Process status<br>
                        <strong>5. Collect Logs</strong> ‚Üí stdout/stderr<br>
                        <strong>6. Resource Limits</strong> ‚Üí cgroups enforcement<br>
                        <strong>7. Stop/Kill</strong> ‚Üí Graceful/Force termination
                    </div>
                </div>
                
                <div class="detail-section">
                    <h3>üîå CRI gRPC Interface</h3>
                    <div class="process-flow">
                        <strong>RuntimeService</strong><br>
                        - RunPodSandbox()<br>
                        - CreateContainer()<br>
                        - StartContainer()<br>
                        - StopContainer()<br><br>
                        
                        <strong>ImageService</strong><br>
                        - PullImage()<br>
                        - ListImages()<br>
                        - RemoveImage()
                    </div>
                    
                    <h3>üìä Isolation</h3>
                    <div class="metric">
                        <span>Namespaces</span>
                        <span class="highlight">PID, NET, MNT, IPC, UTS</span>
                    </div>
                    <div class="metric">
                        <span>Cgroups</span>
                        <span class="highlight">CPU, Memory, IO</span>
                    </div>
                    <div class="metric">
                        <span>Security</span>
                        <span class="highlight">seccomp, AppArmor, SELinux</span>
                    </div>
                </div>
            </div>
            
            <div class="code-block">
# containerd config
[plugins."io.containerd.grpc.v1.cri"]
  sandbox_image = "k8s.gcr.io/pause:3.7"
  [plugins."io.containerd.grpc.v1.cri".containerd]
    default_runtime_name = "runc"
    [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
      runtime_type = "io.containerd.runc.v2"

# Commandes debug
crictl ps                    # List containers
crictl pods                  # List pod sandboxes  
crictl logs CONTAINER_ID     # Container logs
crictl exec -it CONTAINER_ID sh  # Execute in container
            </div>
        </div>
    </div>

    <!-- DNS Details -->
    <div id="detail-dns" class="detail-panel">
        <div class="detail-content">
            <button class="close-btn" onclick="closeDetail()">√ó</button>
            <h2>üîç CoreDNS - R√©solution de Noms</h2>
            
            <div class="detail-sections">
                <div class="detail-section">
                    <h3>üåê Zones DNS Kubernetes</h3>
                    <div class="process-flow">
                        <strong>Services</strong><br>
                        my-service.default.svc.cluster.local<br>
                        ‚Üí ClusterIP du service<br><br>
                        
                        <strong>Pods</strong><br>
                        10-244-1-5.default.pod.cluster.local<br>
                        ‚Üí IP du pod (si enabled)<br><br>
                        
                        <strong>Headless Services</strong><br>
                        nginx-0.nginx-headless.default.svc.cluster.local<br>
                        ‚Üí IP direct du pod
                    </div>
                    
                    <h3>‚ö° Impact D√©ploiement Pod</h3>
                    <div class="process-flow">
                        <strong>Service Created</strong> ‚Üí DNS A record ajout√©<br>
                        <strong>Endpoints Updated</strong> ‚Üí IPs backend mises √† jour<br>
                        <strong>Pod Ready</strong> ‚Üí Inclus dans load balancing<br>
                        <strong>Pod Deleted</strong> ‚Üí Retir√© des r√©ponses DNS
                    </div>
                </div>
                
                <div class="detail-section">
                    <h3>üîß Configuration CoreDNS</h3>
                    <div class="code-block" style="font-size: 0.9em;">
# Corefile
.:53 {
    errors
    health {
        lameduck 5s
    }
    ready
    kubernetes cluster.local in-addr.arpa ip6.arpa {
        pods insecure
        fallthrough in-addr.arpa ip6.arpa
        ttl 30
    }
    prometheus :9153
    forward . /etc/resolv.conf
    cache 30
    loop
    reload
    loadbalance
}
                    </div>
                    
                    <h3>üìä M√©triques</h3>
                    <div class="metric">
                        <span>Requ√™tes/sec</span>
                        <span class="highlight">~1000-5000</span>
                    </div>
                    <div class="metric">
                        <span>Cache TTL</span>
                        <span class="highlight">30s</span>
                    </div>
                    <div class="metric">
                        <span>Port</span>
                        <span class="highlight">53 (UDP/TCP)</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Dashboard Details -->
    <div id="detail-dashboard" class="detail-panel">
        <div class="detail-content">
            <button class="close-btn" onclick="closeDetail()">√ó</button>
            <h2>üìä Dashboard - Interface Web</h2>
            
            <div class="detail-sections">
                <div class="detail-section">
                    <h3>üñ•Ô∏è Fonctionnalit√©s</h3>
                    <ul>
                        <li><strong>Visualisation</strong> - Workloads, Services, Storage</li>
                        <li><strong>Monitoring</strong> - CPU, RAM, Network usage</li>
                        <li><strong>Logs</strong> - Container logs en temps r√©el</li>
                        <li><strong>Shell</strong> - Exec dans les containers</li>
                        <li><strong>√âdition</strong> - YAML manifests</li>
                        <li><strong>Scaling</strong> - Replicas up/down</li>
                    </ul>
                    
                    <h3>‚ö° Suivi D√©ploiement</h3>
                    <div class="process-flow">
                        <strong>Pod Creation</strong> ‚Üí Visible dans Workloads<br>
                        <strong>Status Updates</strong> ‚Üí Pending ‚Üí Running<br>
                        <strong>Resource Usage</strong> ‚Üí Graphiques temps r√©el<br>
                        <strong>Events</strong> ‚Üí Historique des actions<br>
                        <strong>Logs Stream</strong> ‚Üí stdout/stderr live
                    </div>
                </div>
                
                <div class="detail-section">
                    <h3>üîí S√©curit√©</h3>
                    <div class="process-flow">
                        <strong>Authentication</strong><br>
                        - Token Bearer<br>
                        - Certificate client<br>
                        - Basic auth (d√©conseill√©)<br><br>
                        
                        <strong>Authorization</strong><br>
                        - RBAC ClusterRole<br>
                        - Namespace restrictions<br>
                        - Read-only mode disponible
                    </div>
                    
                    <h3>üìä D√©ploiement</h3>
                    <div class="metric">
                        <span>Port service</span>
                        <span class="highlight">443 (HTTPS)</span>
                    </div>
                    <div class="metric">
                        <span>Namespace</span>
                        <span class="highlight">kubernetes-dashboard</span>
                    </div>
                    <div class="metric">
                        <span>Auto-refresh</span>
                        <span class="highlight">30s</span>
                    </div>
                </div>
            </div>
            
            <div class="code-block">
# Installation Dashboard
kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.7.0/aio/deploy/recommended.yaml

# Cr√©er utilisateur admin
apiVersion: v1
kind: ServiceAccount
metadata:
  name: admin-user
  namespace: kubernetes-dashboard
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: admin-user
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: cluster-admin
subjects:
- kind: ServiceAccount
  name: admin-user
  namespace: kubernetes-dashboard

# Obtenir token
kubectl -n kubernetes-dashboard create token admin-user
            </div>
        </div>
    </div>

    <!-- Ingress Controller Details -->
    <div id="detail-ingress" class="detail-panel">
        <div class="detail-content">
            <button class="close-btn" onclick="closeDetail()">√ó</button>
            <h2>üö™ Ingress Controller - Routeur HTTP</h2>
            
            <div class="detail-sections">
                <div class="detail-section">
                    <h3>üåê Contr√¥leurs Populaires</h3>
                    <div class="process-flow">
                        <strong>NGINX Ingress</strong><br>
                        - Plus populaire<br>
                        - Configuration nginx.conf<br>
                        - Load balancing avanc√©<br><br>
                        
                        <strong>Traefik</strong><br>
                        - Auto-discovery<br>
                        - Let's Encrypt int√©gr√©<br>
                        - Dashboard web<br><br>
                        
                        <strong>HAProxy</strong><br>
                        - Performance √©lev√©e<br>
                        - TCP + HTTP support
                    </div>
                    
                    <h3>‚ö° Impact D√©ploiement Pod</h3>
                    <div class="process-flow">
                        <strong>Ingress Resource</strong> ‚Üí Controller d√©tecte<br>
                        <strong>Backend Update</strong> ‚Üí Endpoints du service<br>
                        <strong>Config Reload</strong> ‚Üí Nouvelle route active<br>
                        <strong>Health Checks</strong> ‚Üí Pods readiness<br>
                        <strong>Load Balance</strong> ‚Üí Traffic vers pods
                    </div>
                </div>
                
                <div class="detail-section">
                    <h3>üîß Configuration Exemple</h3>
                    <div class="code-block" style="font-size: 0.9em;">
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: nginx-ingress
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /
spec:
  rules:
  - host: myapp.example.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: nginx-service
            port:
              number: 80
  tls:
  - hosts:
    - myapp.example.com
    secretName: tls-secret
                    </div>
                    
                    <h3>üìä Fonctionnalit√©s</h3>
                    <div class="metric">
                        <span>SSL Termination</span>
                        <span class="highlight">‚úÖ</span>
                    </div>
                    <div class="metric">
                        <span>Path routing</span>
                        <span class="highlight">‚úÖ</span>
                    </div>
                    <div class="metric">
                        <span>Load balancing</span>
                        <span class="highlight">Round-robin, IP Hash</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function showTab(tabName) {
            // Cacher tous les contenus
            document.querySelectorAll('.tab-content').forEach(content => {
                content.style.display = 'none';
            });
            
            // Retirer la classe active de tous les onglets
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Afficher le contenu s√©lectionn√©
            document.getElementById(tabName).style.display = 'block';
            
            // Activer l'onglet cliqu√©
            event.target.classList.add('active');
        }
        
        function showDetail(componentName) {
            const detailPanel = document.getElementById('detail-' + componentName);
            if (detailPanel) {
                detailPanel.style.display = 'block';
                document.body.style.overflow = 'hidden';
            }
        }
        
        function closeDetail() {
            document.querySelectorAll('.detail-panel').forEach(panel => {
                panel.style.display = 'none';
            });
            document.body.style.overflow = 'auto';
        }
        
        // Fermer avec Escape
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeDetail();
            }
        });
        
        // Fermer en cliquant √† l'ext√©rieur
        document.querySelectorAll('.detail-panel').forEach(panel => {
            panel.addEventListener('click', function(e) {
                if (e.target === panel) {
                    closeDetail();
                }
            });
        });
    </script>
</body>
</html>